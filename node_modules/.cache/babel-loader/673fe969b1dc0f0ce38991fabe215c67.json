{"remainingRequest":"/Users/davislin/DavisLin/Case/erp/node_modules/babel-loader/lib/index.js!/Users/davislin/DavisLin/Case/erp/node_modules/eslint-loader/index.js??ref--13-0!/Users/davislin/DavisLin/Case/erp/src/store/auth.module.js","dependencies":[{"path":"/Users/davislin/DavisLin/Case/erp/src/store/auth.module.js","mtime":1580289190000},{"path":"/Users/davislin/DavisLin/Case/erp/node_modules/cache-loader/dist/cjs.js","mtime":1581314282653},{"path":"/Users/davislin/DavisLin/Case/erp/node_modules/babel-loader/lib/index.js","mtime":1587476708600},{"path":"/Users/davislin/DavisLin/Case/erp/node_modules/eslint-loader/index.js","mtime":1586170250463}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL2RhdmlzbGluL0RhdmlzTGluL0Nhc2UvZXJwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7Cgp2YXIgX2FjdGlvbnMsIF9tdXRhdGlvbnM7CgppbXBvcnQgQXBpU2VydmljZSBmcm9tICJAL2NvbW1vbi9hcGkuc2VydmljZSI7CmltcG9ydCBKd3RTZXJ2aWNlIGZyb20gIkAvY29tbW9uL2p3dC5zZXJ2aWNlIjsgLy8gYWN0aW9uIHR5cGVzCgpleHBvcnQgdmFyIFZFUklGWV9BVVRIID0gInZlcmlmeUF1dGgiOwpleHBvcnQgdmFyIExPR0lOID0gImxvZ2luIjsKZXhwb3J0IHZhciBMT0dPVVQgPSAibG9nb3V0IjsKZXhwb3J0IHZhciBSRUdJU1RFUiA9ICJyZWdpc3RlciI7CmV4cG9ydCB2YXIgVVBEQVRFX1VTRVIgPSAidXBkYXRlVXNlciI7IC8vIG11dGF0aW9uIHR5cGVzCgpleHBvcnQgdmFyIFBVUkdFX0FVVEggPSAibG9nT3V0IjsKZXhwb3J0IHZhciBTRVRfQVVUSCA9ICJzZXRVc2VyIjsKZXhwb3J0IHZhciBTRVRfRVJST1IgPSAic2V0RXJyb3IiOwp2YXIgc3RhdGUgPSB7CiAgZXJyb3JzOiBudWxsLAogIHVzZXI6IHt9LAogIGlzQXV0aGVudGljYXRlZDogISFKd3RTZXJ2aWNlLmdldFRva2VuKCkKfTsKdmFyIGdldHRlcnMgPSB7CiAgY3VycmVudFVzZXI6IGZ1bmN0aW9uIGN1cnJlbnRVc2VyKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUudXNlcjsKICB9LAogIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUuaXNBdXRoZW50aWNhdGVkOwogIH0KfTsKdmFyIGFjdGlvbnMgPSAoX2FjdGlvbnMgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9hY3Rpb25zLCBMT0dJTiwgZnVuY3Rpb24gKGNvbnRleHQsIGNyZWRlbnRpYWxzKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICBBcGlTZXJ2aWNlLnBvc3QoImxvZ2luIiwgY3JlZGVudGlhbHMpLnRoZW4oZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgdmFyIGRhdGEgPSBfcmVmLmRhdGE7CiAgICAgIGNvbnRleHQuY29tbWl0KFNFVF9BVVRILCBkYXRhKTsKICAgICAgcmVzb2x2ZShkYXRhKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChfcmVmMikgewogICAgICB2YXIgcmVzcG9uc2UgPSBfcmVmMi5yZXNwb25zZTsKICAgICAgY29udGV4dC5jb21taXQoU0VUX0VSUk9SLCByZXNwb25zZS5kYXRhLmVycm9ycyk7CiAgICB9KTsKICB9KTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgTE9HT1VULCBmdW5jdGlvbiAoY29udGV4dCkgewogIGNvbnRleHQuY29tbWl0KFBVUkdFX0FVVEgpOwp9KSwgX2RlZmluZVByb3BlcnR5KF9hY3Rpb25zLCBSRUdJU1RFUiwgZnVuY3Rpb24gKGNvbnRleHQsIGNyZWRlbnRpYWxzKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIEFwaVNlcnZpY2UucG9zdCgidXNlcnMiLCB7CiAgICAgIHVzZXI6IGNyZWRlbnRpYWxzCiAgICB9KS50aGVuKGZ1bmN0aW9uIChfcmVmMykgewogICAgICB2YXIgZGF0YSA9IF9yZWYzLmRhdGE7CiAgICAgIGNvbnRleHQuY29tbWl0KFNFVF9BVVRILCBkYXRhKTsKICAgICAgcmVzb2x2ZShkYXRhKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICB2YXIgcmVzcG9uc2UgPSBfcmVmNC5yZXNwb25zZTsKICAgICAgY29udGV4dC5jb21taXQoU0VUX0VSUk9SLCByZXNwb25zZS5kYXRhLmVycm9ycyk7CiAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICB9KTsKICB9KTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgVkVSSUZZX0FVVEgsIGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgaWYgKEp3dFNlcnZpY2UuZ2V0VG9rZW4oKSkgewogICAgQXBpU2VydmljZS5zZXRIZWFkZXIoKTsKICAgIEFwaVNlcnZpY2UuZ2V0KCJ2ZXJpZnkiKS50aGVuKGZ1bmN0aW9uIChfcmVmNSkgewogICAgICB2YXIgZGF0YSA9IF9yZWY1LmRhdGE7CiAgICAgIGNvbnRleHQuY29tbWl0KFNFVF9BVVRILCBkYXRhKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChfcmVmNikgewogICAgICB2YXIgcmVzcG9uc2UgPSBfcmVmNi5yZXNwb25zZTsKICAgICAgY29udGV4dC5jb21taXQoU0VUX0VSUk9SLCByZXNwb25zZS5kYXRhLmVycm9ycyk7CiAgICB9KTsKICB9IGVsc2UgewogICAgY29udGV4dC5jb21taXQoUFVSR0VfQVVUSCk7CiAgfQp9KSwgX2RlZmluZVByb3BlcnR5KF9hY3Rpb25zLCBVUERBVEVfVVNFUiwgZnVuY3Rpb24gKGNvbnRleHQsIHBheWxvYWQpIHsKICB2YXIgZW1haWwgPSBwYXlsb2FkLmVtYWlsLAogICAgICB1c2VybmFtZSA9IHBheWxvYWQudXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkID0gcGF5bG9hZC5wYXNzd29yZCwKICAgICAgaW1hZ2UgPSBwYXlsb2FkLmltYWdlLAogICAgICBiaW8gPSBwYXlsb2FkLmJpbzsKICB2YXIgdXNlciA9IHsKICAgIGVtYWlsOiBlbWFpbCwKICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgIGJpbzogYmlvLAogICAgaW1hZ2U6IGltYWdlCiAgfTsKCiAgaWYgKHBhc3N3b3JkKSB7CiAgICB1c2VyLnBhc3N3b3JkID0gcGFzc3dvcmQ7CiAgfQoKICByZXR1cm4gQXBpU2VydmljZS5wdXQoInVzZXIiLCB1c2VyKS50aGVuKGZ1bmN0aW9uIChfcmVmNykgewogICAgdmFyIGRhdGEgPSBfcmVmNy5kYXRhOwogICAgY29udGV4dC5jb21taXQoU0VUX0FVVEgsIGRhdGEpOwogICAgcmV0dXJuIGRhdGE7CiAgfSk7Cn0pLCBfYWN0aW9ucyk7CnZhciBtdXRhdGlvbnMgPSAoX211dGF0aW9ucyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgU0VUX0VSUk9SLCBmdW5jdGlvbiAoc3RhdGUsIGVycm9yKSB7CiAgc3RhdGUuZXJyb3JzID0gZXJyb3I7Cn0pLCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgU0VUX0FVVEgsIGZ1bmN0aW9uIChzdGF0ZSwgdXNlcikgewogIHN0YXRlLmlzQXV0aGVudGljYXRlZCA9IHRydWU7CiAgc3RhdGUudXNlciA9IHVzZXI7CiAgc3RhdGUuZXJyb3JzID0ge307CiAgSnd0U2VydmljZS5zYXZlVG9rZW4oc3RhdGUudXNlci50b2tlbik7Cn0pLCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgUFVSR0VfQVVUSCwgZnVuY3Rpb24gKHN0YXRlKSB7CiAgc3RhdGUuaXNBdXRoZW50aWNhdGVkID0gZmFsc2U7CiAgc3RhdGUudXNlciA9IHt9OwogIHN0YXRlLmVycm9ycyA9IHt9OwogIEp3dFNlcnZpY2UuZGVzdHJveVRva2VuKCk7Cn0pLCBfbXV0YXRpb25zKTsKZXhwb3J0IGRlZmF1bHQgewogIHN0YXRlOiBzdGF0ZSwKICBhY3Rpb25zOiBhY3Rpb25zLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGdldHRlcnM6IGdldHRlcnMKfTs="},{"version":3,"sources":["/Users/davislin/DavisLin/Case/erp/src/store/auth.module.js"],"names":["ApiService","JwtService","VERIFY_AUTH","LOGIN","LOGOUT","REGISTER","UPDATE_USER","PURGE_AUTH","SET_AUTH","SET_ERROR","state","errors","user","isAuthenticated","getToken","getters","currentUser","actions","context","credentials","Promise","resolve","post","then","data","commit","catch","response","reject","setHeader","get","payload","email","username","password","image","bio","put","mutations","error","saveToken","token","destroyToken"],"mappings":"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","sourcesContent":["import ApiService from \"@/common/api.service\";\r\nimport JwtService from \"@/common/jwt.service\";\r\n\r\n// action types\r\nexport const VERIFY_AUTH = \"verifyAuth\";\r\nexport const LOGIN = \"login\";\r\nexport const LOGOUT = \"logout\";\r\nexport const REGISTER = \"register\";\r\nexport const UPDATE_USER = \"updateUser\";\r\n\r\n// mutation types\r\nexport const PURGE_AUTH = \"logOut\";\r\nexport const SET_AUTH = \"setUser\";\r\nexport const SET_ERROR = \"setError\";\r\n\r\nconst state = {\r\n  errors: null,\r\n  user: {},\r\n  isAuthenticated: !!JwtService.getToken()\r\n};\r\n\r\nconst getters = {\r\n  currentUser(state) {\r\n    return state.user;\r\n  },\r\n  isAuthenticated(state) {\r\n    return state.isAuthenticated;\r\n  }\r\n};\r\n\r\nconst actions = {\r\n  [LOGIN](context, credentials) {\r\n    return new Promise(resolve => {\r\n      ApiService.post(\"login\", credentials)\r\n        .then(({ data }) => {\r\n          context.commit(SET_AUTH, data);\r\n          resolve(data);\r\n        })\r\n        .catch(({ response }) => {\r\n          context.commit(SET_ERROR, response.data.errors);\r\n        });\r\n    });\r\n  },\r\n  [LOGOUT](context) {\r\n    context.commit(PURGE_AUTH);\r\n  },\r\n  [REGISTER](context, credentials) {\r\n    return new Promise((resolve, reject) => {\r\n      ApiService.post(\"users\", { user: credentials })\r\n        .then(({ data }) => {\r\n          context.commit(SET_AUTH, data);\r\n          resolve(data);\r\n        })\r\n        .catch(({ response }) => {\r\n          context.commit(SET_ERROR, response.data.errors);\r\n          reject(response);\r\n        });\r\n    });\r\n  },\r\n  [VERIFY_AUTH](context) {\r\n    if (JwtService.getToken()) {\r\n      ApiService.setHeader();\r\n      ApiService.get(\"verify\")\r\n        .then(({ data }) => {\r\n          context.commit(SET_AUTH, data);\r\n        })\r\n        .catch(({ response }) => {\r\n          context.commit(SET_ERROR, response.data.errors);\r\n        });\r\n    } else {\r\n      context.commit(PURGE_AUTH);\r\n    }\r\n  },\r\n  [UPDATE_USER](context, payload) {\r\n    const { email, username, password, image, bio } = payload;\r\n    const user = { email, username, bio, image };\r\n    if (password) {\r\n      user.password = password;\r\n    }\r\n\r\n    return ApiService.put(\"user\", user).then(({ data }) => {\r\n      context.commit(SET_AUTH, data);\r\n      return data;\r\n    });\r\n  }\r\n};\r\n\r\nconst mutations = {\r\n  [SET_ERROR](state, error) {\r\n    state.errors = error;\r\n  },\r\n  [SET_AUTH](state, user) {\r\n    state.isAuthenticated = true;\r\n    state.user = user;\r\n    state.errors = {};\r\n    JwtService.saveToken(state.user.token);\r\n  },\r\n  [PURGE_AUTH](state) {\r\n    state.isAuthenticated = false;\r\n    state.user = {};\r\n    state.errors = {};\r\n    JwtService.destroyToken();\r\n  }\r\n};\r\n\r\nexport default {\r\n  state,\r\n  actions,\r\n  mutations,\r\n  getters\r\n};\r\n"]}]}